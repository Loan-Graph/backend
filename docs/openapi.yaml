openapi: 3.0.3
info:
  title: LoanGraph Backend API
  version: 0.2.0
  description: Backend bootstrap + cookie-based auth with Privy token bootstrap.
servers:
  - url: http://localhost:8090
paths:
  /health:
    get:
      summary: Liveness endpoint
      responses:
        '200':
          description: Service is alive
  /ready:
    get:
      summary: Readiness endpoint with DB check
      responses:
        '200':
          description: Service and DB are ready
        '503':
          description: Service is not ready
  /v1/meta:
    get:
      summary: Service metadata endpoint
      responses:
        '200':
          description: Metadata response
  /v1/auth/privy/login:
    post:
      summary: Login using Privy access token and issue backend auth cookies
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [privy_access_token]
              properties:
                privy_access_token:
                  type: string
      responses:
        '200':
          description: Login success
        '401':
          description: Authentication failed
  /v1/auth/refresh:
    post:
      summary: Rotate refresh cookie and issue new access/refresh cookies
      responses:
        '200':
          description: Refreshed
        '401':
          description: Refresh failed
  /v1/auth/logout:
    post:
      summary: Revoke session and clear cookies
      responses:
        '200':
          description: Logged out
  /v1/auth/me:
    get:
      summary: Get current authenticated user
      responses:
        '200':
          description: User profile
        '401':
          description: Unauthorized
